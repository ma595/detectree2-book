
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Training &#8212; detectree2-book</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Content with notebooks" href="notebooks.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">detectree2-book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="markdown.html">
   Markdown Files
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="notebooks.html">
   Content with notebooks
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Training
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/ma595/detectree2-book/main?urlpath=tree/detectree2-book/trainingJB.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/ma595/detectree2-book/blob/main/detectree2-book/trainingJB.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/ma595/detectree2-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/ma595/detectree2-book/issues/new?title=Issue%20on%20page%20%2FtrainingJB.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/trainingJB.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Training</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="training">
<h1>Training<a class="headerlink" href="#training" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip install git+https://github.com/PatBall1/detectree2.git
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting git+https://github.com/PatBall1/detectree2.git
  Cloning https://github.com/PatBall1/detectree2.git to /private/var/folders/s1/47y4js852f16fm62h0yypbf40000gn/T/pip-req-build-tqop85hd
  Running command git clone --filter=blob:none --quiet https://github.com/PatBall1/detectree2.git /private/var/folders/s1/47y4js852f16fm62h0yypbf40000gn/T/pip-req-build-tqop85hd
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>^C
<span class=" -Color -Color-Red">ERROR: Operation cancelled by user</span>

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">detectron2.data</span> <span class="kn">import</span> <span class="n">DatasetCatalog</span><span class="p">,</span> <span class="n">MetadataCatalog</span>
<span class="kn">from</span> <span class="nn">detectree2.models.train</span> <span class="kn">import</span> <span class="n">get_tree_dicts</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="c1"># necessary libraries</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">glob</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># train_location = &quot;/content/drive/Shareddrives/detectree2/data/Paracou/tiles/data/train/&quot;</span>
<span class="n">train_location</span> <span class="o">=</span> <span class="s2">&quot;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/&quot;</span>
<span class="n">root_dir</span> <span class="o">=</span> <span class="s1">&#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/&#39;</span>
<span class="c1">#train_dirs = os.listdir(train_location)</span>
<span class="n">train_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">train_location</span><span class="p">,</span> <span class="nb">dir</span><span class="p">)</span> <span class="k">for</span> <span class="nb">dir</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">train_location</span><span class="p">)]</span>
<span class="n">train_dirs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_3&#39;,
 &#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_5&#39;,
 &#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_1&#39;,
 &#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_2&#39;,
 &#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_4&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">combine_dicts</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">val_folder</span><span class="p">):</span>
    <span class="n">train_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">folder</span><span class="p">)]</span>
    <span class="k">del</span> <span class="n">train_dirs</span><span class="p">[(</span><span class="n">val_folder</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
    <span class="n">tree_dicts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">train_dirs</span><span class="p">:</span>
        <span class="n">tree_dicts</span> <span class="o">=</span> <span class="n">tree_dicts</span> <span class="o">+</span> <span class="n">get_tree_dicts</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tree_dicts</span>
<span class="n">dicts</span> <span class="o">=</span> <span class="n">combine_dicts</span><span class="p">(</span><span class="n">train_location</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  
<span class="nb">len</span><span class="p">(</span><span class="n">dicts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="n">train_location</span><span class="p">]:</span>
    <span class="n">DatasetCatalog</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;trees_train1&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">:</span> <span class="n">combine_dicts</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">MetadataCatalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;trees_train1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">thing_classes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tree&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]:</span>
    <span class="n">DatasetCatalog</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s2">&quot;trees_test1&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">d</span><span class="o">=</span><span class="n">d</span><span class="p">:</span> <span class="n">get_tree_dicts</span><span class="p">(</span><span class="n">root_dir</span> <span class="o">+</span> <span class="n">d</span><span class="p">))</span>
    <span class="n">MetadataCatalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;trees_test1&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">thing_classes</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tree&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">trees_metadata</span> <span class="o">=</span> <span class="n">MetadataCatalog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;trees_train1&quot;</span><span class="p">)</span>
<span class="n">trees_metadata</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>namespace(name=&#39;trees_train1&#39;, thing_classes=[&#39;tree&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">detectron2.utils.visualizer</span> <span class="kn">import</span> <span class="n">Visualizer</span>
<span class="kn">import</span> <span class="nn">cv2</span>
<span class="n">dataset_dicts</span> <span class="o">=</span> <span class="n">combine_dicts</span><span class="p">(</span><span class="n">train_location</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="c1">#dataset_dicts = get_tree_dicts(&quot;./&quot;)</span>
<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dataset_dicts</span><span class="p">:</span>
<span class="c1">#     print(d)</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s2">&quot;file_name&quot;</span><span class="p">])</span>
    <span class="n">visualizer</span> <span class="o">=</span> <span class="n">Visualizer</span><span class="p">(</span><span class="n">img</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">metadata</span><span class="o">=</span><span class="n">trees_metadata</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">visualizer</span><span class="o">.</span><span class="n">draw_dataset_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">cvtColor</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">get_image</span><span class="p">()[:,</span> <span class="p">:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cv2</span><span class="o">.</span><span class="n">COLOR_BGR2RGB</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">image</span><span class="p">))</span>
    <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/trainingJB_8_0.png" src="_images/trainingJB_8_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">detectree2.models.train</span> <span class="kn">import</span> <span class="n">get_tree_dicts</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="k">def</span> <span class="nf">dataset_function</span><span class="p">(</span><span class="n">folder</span><span class="p">):</span>
    <span class="n">tree_dicts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">train_dirs</span><span class="p">:</span>
        <span class="n">tree_dicts</span> <span class="o">=</span> <span class="n">tree_dicts</span> <span class="o">+</span> <span class="n">get_tree_dicts</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="c1">#time.sleep(1)</span>
    <span class="k">return</span> <span class="n">tree_dicts</span>
<span class="c1"># print(tree_dicts)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">tree_dicts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [9],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">len</span><span class="p">(</span><span class="n">tree_dicts</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;tree_dicts&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">del</span> <span class="n">train_dirs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">train_dirs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_5&#39;,
 &#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_1&#39;,
 &#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_2&#39;,
 &#39;/rds/project/rds-5mCMIDBOkPU/ma595/detectree2/output2/paracou/train/fold_4&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import some common detectron2 utilities</span>
<span class="kn">from</span> <span class="nn">detectron2</span> <span class="kn">import</span> <span class="n">model_zoo</span>
<span class="kn">from</span> <span class="nn">detectron2.engine</span> <span class="kn">import</span> <span class="n">DefaultPredictor</span>
<span class="kn">from</span> <span class="nn">detectron2.config</span> <span class="kn">import</span> <span class="n">get_cfg</span>
<span class="kn">from</span> <span class="nn">detectron2.utils.visualizer</span> <span class="kn">import</span> <span class="n">Visualizer</span>
<span class="kn">from</span> <span class="nn">detectron2.data</span> <span class="kn">import</span> <span class="n">MetadataCatalog</span><span class="p">,</span> <span class="n">DatasetCatalog</span>
<span class="kn">from</span> <span class="nn">detectron2.structures</span> <span class="kn">import</span> <span class="n">BoxMode</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Setup the evaluator</span>

<span class="kn">from</span> <span class="nn">detectron2.evaluation</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CityscapesInstanceEvaluator</span><span class="p">,</span>
    <span class="n">CityscapesSemSegEvaluator</span><span class="p">,</span>
    <span class="n">COCOEvaluator</span><span class="p">,</span>
    <span class="n">COCOPanopticEvaluator</span><span class="p">,</span>
    <span class="n">DatasetEvaluators</span><span class="p">,</span>
    <span class="n">LVISEvaluator</span><span class="p">,</span>
    <span class="n">PascalVOCDetectionEvaluator</span><span class="p">,</span>
    <span class="n">SemSegEvaluator</span><span class="p">,</span>
    <span class="n">verify_results</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">detectron2.evaluation</span> <span class="kn">import</span> <span class="n">COCOEvaluator</span><span class="p">,</span> <span class="n">inference_on_dataset</span>
<span class="kn">from</span> <span class="nn">detectron2.data</span> <span class="kn">import</span> <span class="n">build_detection_test_loader</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">detectron2.engine.hooks</span> <span class="kn">import</span> <span class="n">HookBase</span>
<span class="kn">from</span> <span class="nn">detectron2.evaluation</span> <span class="kn">import</span> <span class="n">inference_context</span>
<span class="kn">from</span> <span class="nn">detectron2.utils.logger</span> <span class="kn">import</span> <span class="n">log_every_n_seconds</span>
<span class="kn">from</span> <span class="nn">detectron2.data</span> <span class="kn">import</span> <span class="n">DatasetMapper</span><span class="p">,</span> <span class="n">build_detection_test_loader</span><span class="p">,</span> <span class="n">build_detection_train_loader</span>
<span class="kn">import</span> <span class="nn">detectron2.utils.comm</span> <span class="k">as</span> <span class="nn">comm</span>
<span class="c1">#import torch</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="k">class</span> <span class="nc">LossEvalHook</span><span class="p">(</span><span class="n">HookBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eval_period</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_model</span> <span class="o">=</span> <span class="n">model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_period</span> <span class="o">=</span> <span class="n">eval_period</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_data_loader</span> <span class="o">=</span> <span class="n">data_loader</span>
    
    <span class="k">def</span> <span class="nf">_do_loss_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Copying inference_on_dataset from evaluator.py</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_loader</span><span class="p">)</span>
        <span class="n">num_warmup</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">total</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">total_compute_time</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">losses</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">inputs</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_data_loader</span><span class="p">):</span>            
            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="n">num_warmup</span><span class="p">:</span>
                <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
                <span class="n">total_compute_time</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">start_compute_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>
            <span class="n">total_compute_time</span> <span class="o">+=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_compute_time</span>
            <span class="n">iters_after_start</span> <span class="o">=</span> <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">num_warmup</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">num_warmup</span><span class="p">)</span>
            <span class="n">seconds_per_img</span> <span class="o">=</span> <span class="n">total_compute_time</span> <span class="o">/</span> <span class="n">iters_after_start</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">num_warmup</span> <span class="o">*</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">seconds_per_img</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">total_seconds_per_img</span> <span class="o">=</span> <span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span> <span class="o">/</span> <span class="n">iters_after_start</span>
                <span class="n">eta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">total_seconds_per_img</span> <span class="o">*</span> <span class="p">(</span><span class="n">total</span> <span class="o">-</span> <span class="n">idx</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
                <span class="n">log_every_n_seconds</span><span class="p">(</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">,</span>
                    <span class="s2">&quot;Loss on Validation  done </span><span class="si">{}</span><span class="s2">/</span><span class="si">{}</span><span class="s2">. </span><span class="si">{:.4f}</span><span class="s2"> s / img. ETA=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">idx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">total</span><span class="p">,</span> <span class="n">seconds_per_img</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">eta</span><span class="p">)</span>
                    <span class="p">),</span>
                    <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">loss_batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_loss</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
            <span class="n">losses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_batch</span><span class="p">)</span>
        <span class="n">mean_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">losses</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">put_scalar</span><span class="p">(</span><span class="s1">&#39;validation_loss&#39;</span><span class="p">,</span> <span class="n">mean_loss</span><span class="p">)</span>
        <span class="n">comm</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">losses</span>
            
    <span class="k">def</span> <span class="nf">_get_loss</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># How loss is calculated on train_loop </span>
        <span class="n">metrics_dict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">metrics_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)</span> <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">metrics_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
        <span class="n">total_losses_reduced</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">loss</span> <span class="k">for</span> <span class="n">loss</span> <span class="ow">in</span> <span class="n">metrics_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">total_losses_reduced</span>
        
        
    <span class="k">def</span> <span class="nf">after_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">next_iter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">iter</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">is_final</span> <span class="o">=</span> <span class="n">next_iter</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">max_iter</span>
        <span class="k">if</span> <span class="n">is_final</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_period</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">next_iter</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_period</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_do_loss_eval</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trainer</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">put_scalars</span><span class="p">(</span><span class="n">timetest</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">detectron2.engine</span> <span class="kn">import</span> <span class="n">DefaultTrainer</span>
<span class="kn">from</span> <span class="nn">detectron2.evaluation</span> <span class="kn">import</span> <span class="n">COCOEvaluator</span>
<span class="kn">import</span> <span class="nn">detectron2.data.transforms</span> <span class="k">as</span> <span class="nn">T</span>
<span class="kn">from</span> <span class="nn">detectron2.data</span> <span class="kn">import</span> <span class="n">detection_utils</span> <span class="k">as</span> <span class="n">utils</span>

<span class="k">class</span> <span class="nc">MyTrainer</span><span class="p">(</span><span class="n">DefaultTrainer</span><span class="p">):</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">build_evaluator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">dataset_name</span><span class="p">,</span> <span class="n">output_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">output_folder</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s2">&quot;eval_2&quot;</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">output_folder</span> <span class="o">=</span> <span class="s2">&quot;eval_2&quot;</span>
        <span class="k">return</span> <span class="n">COCOEvaluator</span><span class="p">(</span><span class="n">dataset_name</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">output_folder</span><span class="p">)</span>
                     
    <span class="k">def</span> <span class="nf">build_hooks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">hooks</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">build_hooks</span><span class="p">()</span>
        <span class="n">hooks</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">LossEvalHook</span><span class="p">(</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">TEST</span><span class="o">.</span><span class="n">EVAL_PERIOD</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span>
            <span class="n">build_detection_test_loader</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">DATASETS</span><span class="o">.</span><span class="n">TEST</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">DatasetMapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="p">))</span>
        <span class="k">return</span> <span class="n">hooks</span>

    <span class="k">def</span> <span class="nf">build_train_loader</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">build_detection_train_loader</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">mapper</span><span class="o">=</span><span class="n">DatasetMapper</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">is_train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">augmentations</span><span class="o">=</span><span class="p">[</span><span class="n">T</span><span class="o">.</span><span class="n">Resize</span><span class="p">((</span><span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">)),</span> <span class="n">T</span><span class="o">.</span><span class="n">RandomBrightness</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.8</span><span class="p">),</span> 
        <span class="n">T</span><span class="o">.</span><span class="n">RandomContrast</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">),</span> <span class="n">T</span><span class="o">.</span><span class="n">RandomSaturation</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">),</span> <span class="n">T</span><span class="o">.</span><span class="n">RandomRotation</span><span class="p">(</span><span class="n">angle</span><span class="o">=</span><span class="p">[</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">],</span> <span class="n">expand</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">T</span><span class="o">.</span><span class="n">RandomLighting</span><span class="p">(</span><span class="mf">0.7</span><span class="p">),</span>
        <span class="n">T</span><span class="o">.</span><span class="n">RandomFlip</span><span class="p">(</span><span class="n">prob</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">horizontal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="kc">True</span><span class="p">)]))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># just setting up the cfg file</span>

<span class="kn">from</span> <span class="nn">detectron2.engine</span> <span class="kn">import</span> <span class="n">DefaultTrainer</span>
<span class="kn">from</span> <span class="nn">detectron2.config</span> <span class="kn">import</span> <span class="n">get_cfg</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">get_cfg</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">merge_from_file</span><span class="p">(</span><span class="n">model_zoo</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">(</span><span class="s2">&quot;COCO-InstanceSegmentation/mask_rcnn_R_101_FPN_3x.yaml&quot;</span><span class="p">))</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">DATASETS</span><span class="o">.</span><span class="n">TRAIN</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;trees_train1&quot;</span><span class="p">,)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">DATASETS</span><span class="o">.</span><span class="n">TEST</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;trees_test1&quot;</span><span class="p">,)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">DATALOADER</span><span class="o">.</span><span class="n">NUM_WORKERS</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">WEIGHTS</span> <span class="o">=</span> <span class="n">model_zoo</span><span class="o">.</span><span class="n">get_checkpoint_url</span><span class="p">(</span><span class="s2">&quot;COCO-InstanceSegmentation/mask_rcnn_R_101_FPN_3x.yaml&quot;</span><span class="p">)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">SOLVER</span><span class="o">.</span><span class="n">IMS_PER_BATCH</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">SOLVER</span><span class="o">.</span><span class="n">BASE_LR</span> <span class="o">=</span> <span class="mf">0.00025</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">SOLVER</span><span class="o">.</span><span class="n">MAX_ITER</span> <span class="o">=</span> <span class="mi">900</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">ROI_HEADS</span><span class="o">.</span><span class="n">NUM_CLASSES</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>An exception occurred in telemetry logging.Disabling telemetry to prevent further exceptions.
Traceback (most recent call last):
  File &quot;/home/ma595/install/install-rds/miniconda3/envs/my_project_env/lib/python3.9/site-packages/iopath/common/file_io.py&quot;, line 946, in __log_tmetry_keys
    handler.log_event()
  File &quot;/home/ma595/install/install-rds/miniconda3/envs/my_project_env/lib/python3.9/site-packages/iopath/common/event_logger.py&quot;, line 97, in log_event
    del self._evt
AttributeError: _evt
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### need to rewrite this to not use DefaultTrainer/DefaultPredictor. This will allow extraction of masks more easily. Pay attention to this. 18/6/21</span>
<span class="c1">### have now done this. I am sick.</span>
<span class="c1"># Train! Can change hyperparameters e.g. learning rate</span>
<span class="c1"># This works excellently, 15/6/21</span>
<span class="c1"># from detectree2.models.train import MyTrainer</span>
<span class="kn">from</span> <span class="nn">detectron2</span> <span class="kn">import</span> <span class="n">model_zoo</span>
<span class="kn">from</span> <span class="nn">detectron2.engine</span> <span class="kn">import</span> <span class="n">DefaultPredictor</span>
<span class="kn">from</span> <span class="nn">detectron2.config</span> <span class="kn">import</span> <span class="n">get_cfg</span>
<span class="kn">from</span> <span class="nn">detectron2.utils.visualizer</span> <span class="kn">import</span> <span class="n">Visualizer</span>
<span class="kn">from</span> <span class="nn">detectron2.data</span> <span class="kn">import</span> <span class="n">MetadataCatalog</span><span class="p">,</span> <span class="n">DatasetCatalog</span>
<span class="kn">from</span> <span class="nn">detectron2.structures</span> <span class="kn">import</span> <span class="n">BoxMode</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">from</span> <span class="nn">detectron2.engine</span> <span class="kn">import</span> <span class="n">DefaultTrainer</span>
<span class="kn">from</span> <span class="nn">detectron2.config</span> <span class="kn">import</span> <span class="n">get_cfg</span>

<span class="n">cfg</span> <span class="o">=</span> <span class="n">get_cfg</span><span class="p">()</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">merge_from_file</span><span class="p">(</span><span class="n">model_zoo</span><span class="o">.</span><span class="n">get_config_file</span><span class="p">(</span><span class="s2">&quot;COCO-InstanceSegmentation/mask_rcnn_R_101_FPN_3x.yaml&quot;</span><span class="p">))</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">DATASETS</span><span class="o">.</span><span class="n">TRAIN</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;trees_train1&quot;</span><span class="p">,)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">DATASETS</span><span class="o">.</span><span class="n">TEST</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;trees_test1&quot;</span><span class="p">,)</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">DATALOADER</span><span class="o">.</span><span class="n">NUM_WORKERS</span> <span class="o">=</span> <span class="mi">2</span>
<span class="c1">#cfg.MODEL.WEIGHTS = model_zoo.get_checkpoint_url(&quot;COCO-InstanceSegmentation/mask_rcnn_R_101_FPN_3x.yaml&quot;)</span>

<span class="c1"># load our pre-trained model if you like</span>
<span class="c1"># cfg.MODEL.WEIGHTS = &#39;gdrive/MyDrive/JamesHirst/model_final.pth&#39;</span>

<span class="n">cfg</span><span class="o">.</span><span class="n">SOLVER</span><span class="o">.</span><span class="n">IMS_PER_BATCH</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">SOLVER</span><span class="o">.</span><span class="n">BASE_LR</span> <span class="o">=</span> <span class="mf">0.0005</span>
<span class="c1"># cfg.SOLVER.WARMUP_ITERS = 500</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">SOLVER</span><span class="o">.</span><span class="n">MAX_ITER</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="c1"># cfg.SOLVER.STEPS = (250,)</span>
<span class="c1"># cfg.SOLVER.GAMMA = 0.5</span>
<span class="n">cfg</span><span class="o">.</span><span class="n">MODEL</span><span class="o">.</span><span class="n">ROI_HEADS</span><span class="o">.</span><span class="n">NUM_CLASSES</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">### From here is the important bit that hasn&#39;t been repeated further up</span>
<span class="c1">#cfg.TEST.EVAL_PERIOD = 100</span>

<span class="c1"># make clear where the output file each time</span>

<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">OUTPUT_DIR</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>



<span class="n">trainer</span> <span class="o">=</span> <span class="n">MyTrainer</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span> 
<span class="n">trainer</span><span class="o">.</span><span class="n">resume_or_load</span><span class="p">(</span><span class="n">resume</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">trainer</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
<span class="c1">#eval_results = inference_on_dataset(trainer.model, val_loader, DatasetEvaluators(evaluator))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">[06/27 23:12:57 d2.engine.defaults]: </span>Model:
GeneralizedRCNN(
  (backbone): FPN(
    (fpn_lateral2): Conv2d(256, 256, kernel_size=(1, 1), stride=(1, 1))
    (fpn_output2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (fpn_lateral3): Conv2d(512, 256, kernel_size=(1, 1), stride=(1, 1))
    (fpn_output3): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (fpn_lateral4): Conv2d(1024, 256, kernel_size=(1, 1), stride=(1, 1))
    (fpn_output4): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (fpn_lateral5): Conv2d(2048, 256, kernel_size=(1, 1), stride=(1, 1))
    (fpn_output5): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (top_block): LastLevelMaxPool()
    (bottom_up): ResNet(
      (stem): BasicStem(
        (conv1): Conv2d(
          3, 64, kernel_size=(7, 7), stride=(2, 2), padding=(3, 3), bias=False
          (norm): FrozenBatchNorm2d(num_features=64, eps=1e-05)
        )
      )
      (res2): Sequential(
        (0): BottleneckBlock(
          (shortcut): Conv2d(
            64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv1): Conv2d(
            64, 64, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=64, eps=1e-05)
          )
          (conv2): Conv2d(
            64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=64, eps=1e-05)
          )
          (conv3): Conv2d(
            64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
        )
        (1): BottleneckBlock(
          (conv1): Conv2d(
            256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=64, eps=1e-05)
          )
          (conv2): Conv2d(
            64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=64, eps=1e-05)
          )
          (conv3): Conv2d(
            64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
        )
        (2): BottleneckBlock(
          (conv1): Conv2d(
            256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=64, eps=1e-05)
          )
          (conv2): Conv2d(
            64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=64, eps=1e-05)
          )
          (conv3): Conv2d(
            64, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
        )
      )
      (res3): Sequential(
        (0): BottleneckBlock(
          (shortcut): Conv2d(
            256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
          (conv1): Conv2d(
            256, 128, kernel_size=(1, 1), stride=(2, 2), bias=False
            (norm): FrozenBatchNorm2d(num_features=128, eps=1e-05)
          )
          (conv2): Conv2d(
            128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=128, eps=1e-05)
          )
          (conv3): Conv2d(
            128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
        )
        (1): BottleneckBlock(
          (conv1): Conv2d(
            512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=128, eps=1e-05)
          )
          (conv2): Conv2d(
            128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=128, eps=1e-05)
          )
          (conv3): Conv2d(
            128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
        )
        (2): BottleneckBlock(
          (conv1): Conv2d(
            512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=128, eps=1e-05)
          )
          (conv2): Conv2d(
            128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=128, eps=1e-05)
          )
          (conv3): Conv2d(
            128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
        )
        (3): BottleneckBlock(
          (conv1): Conv2d(
            512, 128, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=128, eps=1e-05)
          )
          (conv2): Conv2d(
            128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=128, eps=1e-05)
          )
          (conv3): Conv2d(
            128, 512, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
        )
      )
      (res4): Sequential(
        (0): BottleneckBlock(
          (shortcut): Conv2d(
            512, 1024, kernel_size=(1, 1), stride=(2, 2), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
          (conv1): Conv2d(
            512, 256, kernel_size=(1, 1), stride=(2, 2), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (1): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (2): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (3): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (4): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (5): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (6): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (7): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (8): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (9): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (10): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (11): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (12): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (13): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (14): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (15): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (16): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (17): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (18): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (19): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (20): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (21): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
        (22): BottleneckBlock(
          (conv1): Conv2d(
            1024, 256, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv2): Conv2d(
            256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=256, eps=1e-05)
          )
          (conv3): Conv2d(
            256, 1024, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=1024, eps=1e-05)
          )
        )
      )
      (res5): Sequential(
        (0): BottleneckBlock(
          (shortcut): Conv2d(
            1024, 2048, kernel_size=(1, 1), stride=(2, 2), bias=False
            (norm): FrozenBatchNorm2d(num_features=2048, eps=1e-05)
          )
          (conv1): Conv2d(
            1024, 512, kernel_size=(1, 1), stride=(2, 2), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
          (conv2): Conv2d(
            512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
          (conv3): Conv2d(
            512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=2048, eps=1e-05)
          )
        )
        (1): BottleneckBlock(
          (conv1): Conv2d(
            2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
          (conv2): Conv2d(
            512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
          (conv3): Conv2d(
            512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=2048, eps=1e-05)
          )
        )
        (2): BottleneckBlock(
          (conv1): Conv2d(
            2048, 512, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
          (conv2): Conv2d(
            512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=512, eps=1e-05)
          )
          (conv3): Conv2d(
            512, 2048, kernel_size=(1, 1), stride=(1, 1), bias=False
            (norm): FrozenBatchNorm2d(num_features=2048, eps=1e-05)
          )
        )
      )
    )
  )
  (proposal_generator): RPN(
    (rpn_head): StandardRPNHead(
      (conv): Conv2d(
        256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
        (activation): ReLU()
      )
      (objectness_logits): Conv2d(256, 3, kernel_size=(1, 1), stride=(1, 1))
      (anchor_deltas): Conv2d(256, 12, kernel_size=(1, 1), stride=(1, 1))
    )
    (anchor_generator): DefaultAnchorGenerator(
      (cell_anchors): BufferList()
    )
  )
  (roi_heads): StandardROIHeads(
    (box_pooler): ROIPooler(
      (level_poolers): ModuleList(
        (0): ROIAlign(output_size=(7, 7), spatial_scale=0.25, sampling_ratio=0, aligned=True)
        (1): ROIAlign(output_size=(7, 7), spatial_scale=0.125, sampling_ratio=0, aligned=True)
        (2): ROIAlign(output_size=(7, 7), spatial_scale=0.0625, sampling_ratio=0, aligned=True)
        (3): ROIAlign(output_size=(7, 7), spatial_scale=0.03125, sampling_ratio=0, aligned=True)
      )
    )
    (box_head): FastRCNNConvFCHead(
      (flatten): Flatten(start_dim=1, end_dim=-1)
      (fc1): Linear(in_features=12544, out_features=1024, bias=True)
      (fc_relu1): ReLU()
      (fc2): Linear(in_features=1024, out_features=1024, bias=True)
      (fc_relu2): ReLU()
    )
    (box_predictor): FastRCNNOutputLayers(
      (cls_score): Linear(in_features=1024, out_features=2, bias=True)
      (bbox_pred): Linear(in_features=1024, out_features=4, bias=True)
    )
    (mask_pooler): ROIPooler(
      (level_poolers): ModuleList(
        (0): ROIAlign(output_size=(14, 14), spatial_scale=0.25, sampling_ratio=0, aligned=True)
        (1): ROIAlign(output_size=(14, 14), spatial_scale=0.125, sampling_ratio=0, aligned=True)
        (2): ROIAlign(output_size=(14, 14), spatial_scale=0.0625, sampling_ratio=0, aligned=True)
        (3): ROIAlign(output_size=(14, 14), spatial_scale=0.03125, sampling_ratio=0, aligned=True)
      )
    )
    (mask_head): MaskRCNNConvUpsampleHead(
      (mask_fcn1): Conv2d(
        256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
        (activation): ReLU()
      )
      (mask_fcn2): Conv2d(
        256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
        (activation): ReLU()
      )
      (mask_fcn3): Conv2d(
        256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
        (activation): ReLU()
      )
      (mask_fcn4): Conv2d(
        256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1)
        (activation): ReLU()
      )
      (deconv): ConvTranspose2d(256, 256, kernel_size=(2, 2), stride=(2, 2))
      (deconv_relu): ReLU()
      (predictor): Conv2d(256, 1, kernel_size=(1, 1), stride=(1, 1))
    )
  )
)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">[06/27 23:12:57 d2.data.dataset_mapper]: </span>[DatasetMapper] Augmentations used in training: [Resize(shape=(800, 800)), RandomBrightness(intensity_min=0.8, intensity_max=1.8), RandomContrast(intensity_min=0.6, intensity_max=1.3), RandomSaturation(intensity_min=0.8, intensity_max=1.4), RandomRotation(angle=[90, 90], expand=False), RandomLighting(scale=0.7), RandomFlip(prob=0.4, horizontal=False, vertical=True)]
<span class=" -Color -Color-Green">[06/27 23:12:57 d2.data.build]: </span>Removed 0 images with no usable annotations. 21 images left.
<span class=" -Color -Color-Green">[06/27 23:12:57 d2.data.build]: </span>Using training sampler TrainingSampler
<span class=" -Color -Color-Green">[06/27 23:12:57 d2.data.common]: </span>Serializing 21 elements to byte tensors and concatenating them all ...
<span class=" -Color -Color-Green">[06/27 23:12:57 d2.data.common]: </span>Serialized dataset takes 1.97 MiB
<span class=" -Color -Color-Red">WARNING</span> <span class=" -Color -Color-Green">[06/27 23:12:57 d2.solver.build]: </span>SOLVER.STEPS contains values larger than SOLVER.MAX_ITER. These values will be ignored.
<span class=" -Color -Color-Green">[06/27 23:12:57 d2.data.dataset_mapper]: </span>[DatasetMapper] Augmentations used in training: [ResizeShortestEdge(short_edge_length=(640, 672, 704, 736, 768, 800), max_size=1333, sample_style=&#39;choice&#39;), RandomFlip()]
<span class=" -Color -Color-Green">[06/27 23:13:08 d2.data.common]: </span>Serializing 7 elements to byte tensors and concatenating them all ...
<span class=" -Color -Color-Green">[06/27 23:13:08 d2.data.common]: </span>Serialized dataset takes 0.58 MiB
<span class=" -Color -Color-Green">[06/27 23:13:08 d2.checkpoint.c2_model_loading]: </span>Renaming Caffe2 weights ......
<span class=" -Color -Color-Green">[06/27 23:13:08 d2.checkpoint.c2_model_loading]: </span>Following weights matched with submodule backbone.bottom_up:
| Names in Model    | Names in Checkpoint       | Shapes                                          |
|:------------------|:--------------------------|:------------------------------------------------|
| res2.0.conv1.*    | res2_0_branch2a_{bn_*,w}  | (64,) (64,) (64,) (64,) (64,64,1,1)             |
| res2.0.conv2.*    | res2_0_branch2b_{bn_*,w}  | (64,) (64,) (64,) (64,) (64,64,3,3)             |
| res2.0.conv3.*    | res2_0_branch2c_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,64,1,1)        |
| res2.0.shortcut.* | res2_0_branch1_{bn_*,w}   | (256,) (256,) (256,) (256,) (256,64,1,1)        |
| res2.1.conv1.*    | res2_1_branch2a_{bn_*,w}  | (64,) (64,) (64,) (64,) (64,256,1,1)            |
| res2.1.conv2.*    | res2_1_branch2b_{bn_*,w}  | (64,) (64,) (64,) (64,) (64,64,3,3)             |
| res2.1.conv3.*    | res2_1_branch2c_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,64,1,1)        |
| res2.2.conv1.*    | res2_2_branch2a_{bn_*,w}  | (64,) (64,) (64,) (64,) (64,256,1,1)            |
| res2.2.conv2.*    | res2_2_branch2b_{bn_*,w}  | (64,) (64,) (64,) (64,) (64,64,3,3)             |
| res2.2.conv3.*    | res2_2_branch2c_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,64,1,1)        |
| res3.0.conv1.*    | res3_0_branch2a_{bn_*,w}  | (128,) (128,) (128,) (128,) (128,256,1,1)       |
| res3.0.conv2.*    | res3_0_branch2b_{bn_*,w}  | (128,) (128,) (128,) (128,) (128,128,3,3)       |
| res3.0.conv3.*    | res3_0_branch2c_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,128,1,1)       |
| res3.0.shortcut.* | res3_0_branch1_{bn_*,w}   | (512,) (512,) (512,) (512,) (512,256,1,1)       |
| res3.1.conv1.*    | res3_1_branch2a_{bn_*,w}  | (128,) (128,) (128,) (128,) (128,512,1,1)       |
| res3.1.conv2.*    | res3_1_branch2b_{bn_*,w}  | (128,) (128,) (128,) (128,) (128,128,3,3)       |
| res3.1.conv3.*    | res3_1_branch2c_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,128,1,1)       |
| res3.2.conv1.*    | res3_2_branch2a_{bn_*,w}  | (128,) (128,) (128,) (128,) (128,512,1,1)       |
| res3.2.conv2.*    | res3_2_branch2b_{bn_*,w}  | (128,) (128,) (128,) (128,) (128,128,3,3)       |
| res3.2.conv3.*    | res3_2_branch2c_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,128,1,1)       |
| res3.3.conv1.*    | res3_3_branch2a_{bn_*,w}  | (128,) (128,) (128,) (128,) (128,512,1,1)       |
| res3.3.conv2.*    | res3_3_branch2b_{bn_*,w}  | (128,) (128,) (128,) (128,) (128,128,3,3)       |
| res3.3.conv3.*    | res3_3_branch2c_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,128,1,1)       |
| res4.0.conv1.*    | res4_0_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,512,1,1)       |
| res4.0.conv2.*    | res4_0_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.0.conv3.*    | res4_0_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.0.shortcut.* | res4_0_branch1_{bn_*,w}   | (1024,) (1024,) (1024,) (1024,) (1024,512,1,1)  |
| res4.1.conv1.*    | res4_1_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.1.conv2.*    | res4_1_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.1.conv3.*    | res4_1_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.10.conv1.*   | res4_10_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.10.conv2.*   | res4_10_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.10.conv3.*   | res4_10_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.11.conv1.*   | res4_11_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.11.conv2.*   | res4_11_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.11.conv3.*   | res4_11_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.12.conv1.*   | res4_12_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.12.conv2.*   | res4_12_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.12.conv3.*   | res4_12_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.13.conv1.*   | res4_13_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.13.conv2.*   | res4_13_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.13.conv3.*   | res4_13_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.14.conv1.*   | res4_14_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.14.conv2.*   | res4_14_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.14.conv3.*   | res4_14_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.15.conv1.*   | res4_15_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.15.conv2.*   | res4_15_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.15.conv3.*   | res4_15_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.16.conv1.*   | res4_16_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.16.conv2.*   | res4_16_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.16.conv3.*   | res4_16_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.17.conv1.*   | res4_17_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.17.conv2.*   | res4_17_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.17.conv3.*   | res4_17_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.18.conv1.*   | res4_18_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.18.conv2.*   | res4_18_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.18.conv3.*   | res4_18_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.19.conv1.*   | res4_19_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.19.conv2.*   | res4_19_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.19.conv3.*   | res4_19_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.2.conv1.*    | res4_2_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.2.conv2.*    | res4_2_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.2.conv3.*    | res4_2_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.20.conv1.*   | res4_20_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.20.conv2.*   | res4_20_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.20.conv3.*   | res4_20_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.21.conv1.*   | res4_21_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.21.conv2.*   | res4_21_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.21.conv3.*   | res4_21_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.22.conv1.*   | res4_22_branch2a_{bn_*,w} | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.22.conv2.*   | res4_22_branch2b_{bn_*,w} | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.22.conv3.*   | res4_22_branch2c_{bn_*,w} | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.3.conv1.*    | res4_3_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.3.conv2.*    | res4_3_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.3.conv3.*    | res4_3_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.4.conv1.*    | res4_4_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.4.conv2.*    | res4_4_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.4.conv3.*    | res4_4_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.5.conv1.*    | res4_5_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.5.conv2.*    | res4_5_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.5.conv3.*    | res4_5_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.6.conv1.*    | res4_6_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.6.conv2.*    | res4_6_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.6.conv3.*    | res4_6_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.7.conv1.*    | res4_7_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.7.conv2.*    | res4_7_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.7.conv3.*    | res4_7_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.8.conv1.*    | res4_8_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.8.conv2.*    | res4_8_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.8.conv3.*    | res4_8_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res4.9.conv1.*    | res4_9_branch2a_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,1024,1,1)      |
| res4.9.conv2.*    | res4_9_branch2b_{bn_*,w}  | (256,) (256,) (256,) (256,) (256,256,3,3)       |
| res4.9.conv3.*    | res4_9_branch2c_{bn_*,w}  | (1024,) (1024,) (1024,) (1024,) (1024,256,1,1)  |
| res5.0.conv1.*    | res5_0_branch2a_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,1024,1,1)      |
| res5.0.conv2.*    | res5_0_branch2b_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,512,3,3)       |
| res5.0.conv3.*    | res5_0_branch2c_{bn_*,w}  | (2048,) (2048,) (2048,) (2048,) (2048,512,1,1)  |
| res5.0.shortcut.* | res5_0_branch1_{bn_*,w}   | (2048,) (2048,) (2048,) (2048,) (2048,1024,1,1) |
| res5.1.conv1.*    | res5_1_branch2a_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,2048,1,1)      |
| res5.1.conv2.*    | res5_1_branch2b_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,512,3,3)       |
| res5.1.conv3.*    | res5_1_branch2c_{bn_*,w}  | (2048,) (2048,) (2048,) (2048,) (2048,512,1,1)  |
| res5.2.conv1.*    | res5_2_branch2a_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,2048,1,1)      |
| res5.2.conv2.*    | res5_2_branch2b_{bn_*,w}  | (512,) (512,) (512,) (512,) (512,512,3,3)       |
| res5.2.conv3.*    | res5_2_branch2c_{bn_*,w}  | (2048,) (2048,) (2048,) (2048,) (2048,512,1,1)  |
| stem.conv1.norm.* | res_conv1_bn_*            | (64,) (64,) (64,) (64,)                         |
| stem.conv1.weight | conv1_w                   | (64, 3, 7, 7)                                   |
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Some model parameters or buffers are not found in the checkpoint:
<span class=" -Color -Color-Blue">backbone.fpn_lateral2.{bias, weight}</span>
<span class=" -Color -Color-Blue">backbone.fpn_lateral3.{bias, weight}</span>
<span class=" -Color -Color-Blue">backbone.fpn_lateral4.{bias, weight}</span>
<span class=" -Color -Color-Blue">backbone.fpn_lateral5.{bias, weight}</span>
<span class=" -Color -Color-Blue">backbone.fpn_output2.{bias, weight}</span>
<span class=" -Color -Color-Blue">backbone.fpn_output3.{bias, weight}</span>
<span class=" -Color -Color-Blue">backbone.fpn_output4.{bias, weight}</span>
<span class=" -Color -Color-Blue">backbone.fpn_output5.{bias, weight}</span>
<span class=" -Color -Color-Blue">proposal_generator.rpn_head.anchor_deltas.{bias, weight}</span>
<span class=" -Color -Color-Blue">proposal_generator.rpn_head.conv.{bias, weight}</span>
<span class=" -Color -Color-Blue">proposal_generator.rpn_head.objectness_logits.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.box_head.fc1.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.box_head.fc2.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.box_predictor.bbox_pred.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.box_predictor.cls_score.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.mask_head.deconv.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.mask_head.mask_fcn1.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.mask_head.mask_fcn2.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.mask_head.mask_fcn3.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.mask_head.mask_fcn4.{bias, weight}</span>
<span class=" -Color -Color-Blue">roi_heads.mask_head.predictor.{bias, weight}</span>
The checkpoint state_dict contains keys that are not used by the model:
  <span class=" -Color -Color-Magenta">fc1000.{bias, weight}</span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">[06/27 23:13:08 d2.engine.train_loop]: </span>Starting training from iteration 0
<span class=" -Color -Color-Green">[06/27 23:13:11 d2.utils.events]: </span> eta: 0:02:02  iter: 19  total_loss: 3.01  loss_cls: 0.7666  loss_box_reg: 0.3373  loss_mask: 0.6927  loss_rpn_cls: 0.6879  loss_rpn_loc: 0.5149  time: 0.1253  data_time: 0.0268  lr: 9.9905e-06  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:14 d2.utils.events]: </span> eta: 0:01:58  iter: 39  total_loss: 2.795  loss_cls: 0.5628  loss_box_reg: 0.3733  loss_mask: 0.6856  loss_rpn_cls: 0.6803  loss_rpn_loc: 0.4868  time: 0.1234  data_time: 0.0057  lr: 1.998e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:16 d2.utils.events]: </span> eta: 0:01:56  iter: 59  total_loss: 2.728  loss_cls: 0.5605  loss_box_reg: 0.3865  loss_mask: 0.6729  loss_rpn_cls: 0.6655  loss_rpn_loc: 0.4532  time: 0.1241  data_time: 0.0092  lr: 2.997e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:19 d2.utils.events]: </span> eta: 0:01:54  iter: 79  total_loss: 2.736  loss_cls: 0.5444  loss_box_reg: 0.4262  loss_mask: 0.6643  loss_rpn_cls: 0.6504  loss_rpn_loc: 0.4485  time: 0.1242  data_time: 0.0078  lr: 3.9961e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:21 d2.utils.events]: </span> eta: 0:01:51  iter: 99  total_loss: 2.739  loss_cls: 0.541  loss_box_reg: 0.4761  loss_mask: 0.6553  loss_rpn_cls: 0.6241  loss_rpn_loc: 0.4535  time: 0.1243  data_time: 0.0079  lr: 4.9951e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:24 d2.utils.events]: </span> eta: 0:01:49  iter: 119  total_loss: 2.69  loss_cls: 0.5288  loss_box_reg: 0.4635  loss_mask: 0.6531  loss_rpn_cls: 0.5934  loss_rpn_loc: 0.4273  time: 0.1243  data_time: 0.0069  lr: 5.994e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:26 d2.utils.events]: </span> eta: 0:01:46  iter: 139  total_loss: 2.685  loss_cls: 0.5252  loss_box_reg: 0.4731  loss_mask: 0.652  loss_rpn_cls: 0.5821  loss_rpn_loc: 0.4524  time: 0.1243  data_time: 0.0072  lr: 6.9931e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:29 d2.utils.events]: </span> eta: 0:01:44  iter: 159  total_loss: 2.636  loss_cls: 0.5134  loss_box_reg: 0.4902  loss_mask: 0.6553  loss_rpn_cls: 0.5516  loss_rpn_loc: 0.4396  time: 0.1242  data_time: 0.0076  lr: 7.9921e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:31 d2.utils.events]: </span> eta: 0:01:41  iter: 179  total_loss: 2.614  loss_cls: 0.5024  loss_box_reg: 0.483  loss_mask: 0.6531  loss_rpn_cls: 0.5331  loss_rpn_loc: 0.4465  time: 0.1242  data_time: 0.0074  lr: 8.991e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:34 d2.utils.events]: </span> eta: 0:01:39  iter: 199  total_loss: 2.565  loss_cls: 0.4862  loss_box_reg: 0.5103  loss_mask: 0.6524  loss_rpn_cls: 0.5021  loss_rpn_loc: 0.4416  time: 0.1242  data_time: 0.0072  lr: 9.9901e-05  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:36 d2.utils.events]: </span> eta: 0:01:36  iter: 219  total_loss: 2.519  loss_cls: 0.4697  loss_box_reg: 0.4668  loss_mask: 0.647  loss_rpn_cls: 0.4954  loss_rpn_loc: 0.4222  time: 0.1242  data_time: 0.0067  lr: 0.00010989  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:39 d2.utils.events]: </span> eta: 0:01:34  iter: 239  total_loss: 2.481  loss_cls: 0.4514  loss_box_reg: 0.4982  loss_mask: 0.6443  loss_rpn_cls: 0.4765  loss_rpn_loc: 0.4118  time: 0.1242  data_time: 0.0074  lr: 0.00011988  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:41 d2.utils.events]: </span> eta: 0:01:31  iter: 259  total_loss: 2.496  loss_cls: 0.4411  loss_box_reg: 0.4954  loss_mask: 0.6426  loss_rpn_cls: 0.4942  loss_rpn_loc: 0.4298  time: 0.1242  data_time: 0.0065  lr: 0.00012987  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:44 d2.utils.events]: </span> eta: 0:01:29  iter: 279  total_loss: 2.47  loss_cls: 0.4292  loss_box_reg: 0.4939  loss_mask: 0.6365  loss_rpn_cls: 0.4681  loss_rpn_loc: 0.4387  time: 0.1242  data_time: 0.0070  lr: 0.00013986  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:46 d2.utils.events]: </span> eta: 0:01:26  iter: 299  total_loss: 2.406  loss_cls: 0.4141  loss_box_reg: 0.4918  loss_mask: 0.6337  loss_rpn_cls: 0.4527  loss_rpn_loc: 0.3867  time: 0.1242  data_time: 0.0059  lr: 0.00014985  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:49 d2.utils.events]: </span> eta: 0:01:24  iter: 319  total_loss: 2.44  loss_cls: 0.4204  loss_box_reg: 0.5138  loss_mask: 0.6272  loss_rpn_cls: 0.453  loss_rpn_loc: 0.3943  time: 0.1242  data_time: 0.0071  lr: 0.00015984  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:51 d2.utils.events]: </span> eta: 0:01:21  iter: 339  total_loss: 2.432  loss_cls: 0.4253  loss_box_reg: 0.5499  loss_mask: 0.6283  loss_rpn_cls: 0.4517  loss_rpn_loc: 0.3879  time: 0.1242  data_time: 0.0051  lr: 0.00016983  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:54 d2.utils.events]: </span> eta: 0:01:19  iter: 359  total_loss: 2.441  loss_cls: 0.4411  loss_box_reg: 0.5574  loss_mask: 0.6259  loss_rpn_cls: 0.4296  loss_rpn_loc: 0.3964  time: 0.1242  data_time: 0.0063  lr: 0.00017982  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:56 d2.utils.events]: </span> eta: 0:01:16  iter: 379  total_loss: 2.511  loss_cls: 0.4529  loss_box_reg: 0.5936  loss_mask: 0.6173  loss_rpn_cls: 0.4396  loss_rpn_loc: 0.3764  time: 0.1242  data_time: 0.0052  lr: 0.00018981  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:13:59 d2.utils.events]: </span> eta: 0:01:14  iter: 399  total_loss: 2.47  loss_cls: 0.4477  loss_box_reg: 0.5887  loss_mask: 0.6103  loss_rpn_cls: 0.42  loss_rpn_loc: 0.3924  time: 0.1242  data_time: 0.0046  lr: 0.0001998  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:01 d2.utils.events]: </span> eta: 0:01:12  iter: 419  total_loss: 2.433  loss_cls: 0.4259  loss_box_reg: 0.5937  loss_mask: 0.6041  loss_rpn_cls: 0.4166  loss_rpn_loc: 0.3797  time: 0.1242  data_time: 0.0049  lr: 0.00020979  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:04 d2.utils.events]: </span> eta: 0:01:09  iter: 439  total_loss: 2.445  loss_cls: 0.4193  loss_box_reg: 0.5958  loss_mask: 0.5918  loss_rpn_cls: 0.4095  loss_rpn_loc: 0.384  time: 0.1242  data_time: 0.0039  lr: 0.00021978  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:06 d2.utils.events]: </span> eta: 0:01:07  iter: 459  total_loss: 2.359  loss_cls: 0.4161  loss_box_reg: 0.5998  loss_mask: 0.5858  loss_rpn_cls: 0.4103  loss_rpn_loc: 0.3662  time: 0.1244  data_time: 0.0040  lr: 0.00022977  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:09 d2.utils.events]: </span> eta: 0:01:04  iter: 479  total_loss: 2.355  loss_cls: 0.4029  loss_box_reg: 0.6036  loss_mask: 0.5779  loss_rpn_cls: 0.3934  loss_rpn_loc: 0.3761  time: 0.1245  data_time: 0.0055  lr: 0.00023976  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:11 d2.utils.events]: </span> eta: 0:01:02  iter: 499  total_loss: 2.331  loss_cls: 0.3927  loss_box_reg: 0.6001  loss_mask: 0.5757  loss_rpn_cls: 0.3945  loss_rpn_loc: 0.3544  time: 0.1246  data_time: 0.0057  lr: 0.00024975  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:14 d2.utils.events]: </span> eta: 0:00:59  iter: 519  total_loss: 2.284  loss_cls: 0.3885  loss_box_reg: 0.5946  loss_mask: 0.5703  loss_rpn_cls: 0.3801  loss_rpn_loc: 0.3459  time: 0.1245  data_time: 0.0035  lr: 0.00025974  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:16 d2.utils.events]: </span> eta: 0:00:57  iter: 539  total_loss: 2.256  loss_cls: 0.3856  loss_box_reg: 0.5904  loss_mask: 0.5661  loss_rpn_cls: 0.3831  loss_rpn_loc: 0.3376  time: 0.1245  data_time: 0.0042  lr: 0.00026973  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:19 d2.utils.events]: </span> eta: 0:00:54  iter: 559  total_loss: 2.245  loss_cls: 0.3773  loss_box_reg: 0.5788  loss_mask: 0.5633  loss_rpn_cls: 0.3862  loss_rpn_loc: 0.346  time: 0.1245  data_time: 0.0039  lr: 0.00027972  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:21 d2.utils.events]: </span> eta: 0:00:52  iter: 579  total_loss: 2.268  loss_cls: 0.3842  loss_box_reg: 0.5968  loss_mask: 0.5644  loss_rpn_cls: 0.3598  loss_rpn_loc: 0.3327  time: 0.1244  data_time: 0.0039  lr: 0.00028971  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:24 d2.utils.events]: </span> eta: 0:00:49  iter: 599  total_loss: 2.284  loss_cls: 0.4119  loss_box_reg: 0.6046  loss_mask: 0.559  loss_rpn_cls: 0.3582  loss_rpn_loc: 0.3473  time: 0.1244  data_time: 0.0037  lr: 0.0002997  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:26 d2.utils.events]: </span> eta: 0:00:47  iter: 619  total_loss: 2.205  loss_cls: 0.3875  loss_box_reg: 0.6022  loss_mask: 0.5576  loss_rpn_cls: 0.3591  loss_rpn_loc: 0.3151  time: 0.1244  data_time: 0.0035  lr: 0.00030969  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:29 d2.utils.events]: </span> eta: 0:00:44  iter: 639  total_loss: 2.189  loss_cls: 0.3702  loss_box_reg: 0.5937  loss_mask: 0.5518  loss_rpn_cls: 0.3345  loss_rpn_loc: 0.3368  time: 0.1244  data_time: 0.0033  lr: 0.00031968  max_mem: 3723M
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">[06/27 23:14:31 d2.utils.events]: </span> eta: 0:00:42  iter: 659  total_loss: 2.208  loss_cls: 0.3675  loss_box_reg: 0.6056  loss_mask: 0.5479  loss_rpn_cls: 0.3247  loss_rpn_loc: 0.344  time: 0.1243  data_time: 0.0041  lr: 0.00032967  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:34 d2.utils.events]: </span> eta: 0:00:39  iter: 679  total_loss: 2.178  loss_cls: 0.3735  loss_box_reg: 0.606  loss_mask: 0.5466  loss_rpn_cls: 0.3338  loss_rpn_loc: 0.3246  time: 0.1243  data_time: 0.0036  lr: 0.00033966  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:36 d2.utils.events]: </span> eta: 0:00:37  iter: 699  total_loss: 2.238  loss_cls: 0.3959  loss_box_reg: 0.6385  loss_mask: 0.5458  loss_rpn_cls: 0.3298  loss_rpn_loc: 0.3192  time: 0.1243  data_time: 0.0047  lr: 0.00034965  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:39 d2.utils.events]: </span> eta: 0:00:34  iter: 719  total_loss: 2.218  loss_cls: 0.3814  loss_box_reg: 0.6416  loss_mask: 0.5487  loss_rpn_cls: 0.3109  loss_rpn_loc: 0.3248  time: 0.1243  data_time: 0.0049  lr: 0.00035964  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:41 d2.utils.events]: </span> eta: 0:00:32  iter: 739  total_loss: 2.182  loss_cls: 0.3892  loss_box_reg: 0.6283  loss_mask: 0.5474  loss_rpn_cls: 0.3052  loss_rpn_loc: 0.297  time: 0.1243  data_time: 0.0050  lr: 0.00036963  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:44 d2.utils.events]: </span> eta: 0:00:29  iter: 759  total_loss: 2.19  loss_cls: 0.3897  loss_box_reg: 0.6265  loss_mask: 0.5364  loss_rpn_cls: 0.2993  loss_rpn_loc: 0.3091  time: 0.1243  data_time: 0.0046  lr: 0.00037962  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:46 d2.utils.events]: </span> eta: 0:00:27  iter: 779  total_loss: 2.188  loss_cls: 0.4041  loss_box_reg: 0.6264  loss_mask: 0.5378  loss_rpn_cls: 0.2945  loss_rpn_loc: 0.2975  time: 0.1242  data_time: 0.0039  lr: 0.00038961  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:49 d2.utils.events]: </span> eta: 0:00:24  iter: 799  total_loss: 2.178  loss_cls: 0.3944  loss_box_reg: 0.6484  loss_mask: 0.5331  loss_rpn_cls: 0.2758  loss_rpn_loc: 0.2996  time: 0.1242  data_time: 0.0065  lr: 0.0003996  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:51 d2.utils.events]: </span> eta: 0:00:22  iter: 819  total_loss: 2.156  loss_cls: 0.3989  loss_box_reg: 0.6335  loss_mask: 0.5335  loss_rpn_cls: 0.2728  loss_rpn_loc: 0.3041  time: 0.1242  data_time: 0.0048  lr: 0.00040959  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:54 d2.utils.events]: </span> eta: 0:00:19  iter: 839  total_loss: 2.132  loss_cls: 0.4023  loss_box_reg: 0.6304  loss_mask: 0.5261  loss_rpn_cls: 0.2563  loss_rpn_loc: 0.2984  time: 0.1241  data_time: 0.0062  lr: 0.00041958  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:56 d2.utils.events]: </span> eta: 0:00:17  iter: 859  total_loss: 2.131  loss_cls: 0.4211  loss_box_reg: 0.6315  loss_mask: 0.5247  loss_rpn_cls: 0.2551  loss_rpn_loc: 0.2807  time: 0.1242  data_time: 0.0097  lr: 0.00042957  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:14:59 d2.utils.events]: </span> eta: 0:00:14  iter: 879  total_loss: 2.082  loss_cls: 0.3997  loss_box_reg: 0.6172  loss_mask: 0.5299  loss_rpn_cls: 0.2614  loss_rpn_loc: 0.3008  time: 0.1242  data_time: 0.0074  lr: 0.00043956  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:15:01 d2.utils.events]: </span> eta: 0:00:12  iter: 899  total_loss: 2.067  loss_cls: 0.3936  loss_box_reg: 0.6281  loss_mask: 0.5218  loss_rpn_cls: 0.2283  loss_rpn_loc: 0.2723  time: 0.1242  data_time: 0.0076  lr: 0.00044955  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:15:04 d2.utils.events]: </span> eta: 0:00:09  iter: 919  total_loss: 2.056  loss_cls: 0.3937  loss_box_reg: 0.6235  loss_mask: 0.5222  loss_rpn_cls: 0.2358  loss_rpn_loc: 0.2609  time: 0.1242  data_time: 0.0084  lr: 0.00045954  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:15:06 d2.utils.events]: </span> eta: 0:00:07  iter: 939  total_loss: 2.029  loss_cls: 0.3893  loss_box_reg: 0.6038  loss_mask: 0.5163  loss_rpn_cls: 0.2286  loss_rpn_loc: 0.2593  time: 0.1242  data_time: 0.0091  lr: 0.00046953  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:15:09 d2.utils.events]: </span> eta: 0:00:04  iter: 959  total_loss: 2.012  loss_cls: 0.3708  loss_box_reg: 0.6065  loss_mask: 0.516  loss_rpn_cls: 0.2146  loss_rpn_loc: 0.28  time: 0.1242  data_time: 0.0042  lr: 0.00047952  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:15:11 d2.utils.events]: </span> eta: 0:00:02  iter: 979  total_loss: 2.054  loss_cls: 0.3866  loss_box_reg: 0.6188  loss_mask: 0.5298  loss_rpn_cls: 0.2164  loss_rpn_loc: 0.3007  time: 0.1242  data_time: 0.0079  lr: 0.00048951  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:15:15 d2.utils.events]: </span> eta: 0:00:00  iter: 999  total_loss: 1.96  loss_cls: 0.3723  loss_box_reg: 0.6046  loss_mask: 0.5152  loss_rpn_cls: 0.2065  loss_rpn_loc: 0.2545  validation_loss: 2.67  time: 0.1242  data_time: 0.0084  lr: 0.0004995  max_mem: 3723M
<span class=" -Color -Color-Green">[06/27 23:15:15 d2.engine.hooks]: </span>Overall training speed: 998 iterations in 0:02:03 (0.1242 s / it)
<span class=" -Color -Color-Green">[06/27 23:15:15 d2.engine.hooks]: </span>Total training time: 0:02:06 (0:00:02 on hooks)
<span class=" -Color -Color-Green">[06/27 23:15:15 d2.data.dataset_mapper]: </span>[DatasetMapper] Augmentations used in inference: [ResizeShortestEdge(short_edge_length=(800, 800), max_size=1333, sample_style=&#39;choice&#39;)]
<span class=" -Color -Color-Green">[06/27 23:15:15 d2.data.common]: </span>Serializing 7 elements to byte tensors and concatenating them all ...
<span class=" -Color -Color-Green">[06/27 23:15:15 d2.data.common]: </span>Serialized dataset takes 0.58 MiB
<span class=" -Color -Color-Red">WARNING</span> <span class=" -Color -Color-Green">[06/27 23:15:15 d2.evaluation.coco_evaluation]: </span>COCO Evaluator instantiated using config, this is deprecated behavior. Please pass in explicit arguments instead.
<span class=" -Color -Color-Green">[06/27 23:15:15 d2.evaluation.evaluator]: </span>Start inference on 7 batches
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.evaluator]: </span>Total inference time: 0:00:00.481544 (0.240772 s / iter per device, on 1 devices)
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.evaluator]: </span>Total inference pure compute time: 0:00:00 (0.031641 s / iter per device, on 1 devices)
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.coco_evaluation]: </span>Preparing results for COCO format ...
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.coco_evaluation]: </span>Saving results to eval_2/coco_instances_results.json
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.coco_evaluation]: </span>Evaluating predictions with unofficial COCO API...
Loading and preparing results...
DONE (t=0.00s)
creating index...
index created!
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.fast_eval_api]: </span>Evaluate annotation type *bbox*
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.fast_eval_api]: </span>COCOeval_opt.evaluate() finished in 0.01 seconds.
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.fast_eval_api]: </span>Accumulating evaluation results...
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.fast_eval_api]: </span>COCOeval_opt.accumulate() finished in 0.00 seconds.
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.096
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.268
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.036
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.006
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.066
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.191
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.004
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.043
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.172
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.021
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.124
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.323
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.coco_evaluation]: </span>Evaluation results for bbox: 
|  AP   |  AP50  |  AP75  |  APs  |  APm  |  APl   |
|:-----:|:------:|:------:|:-----:|:-----:|:------:|
| 9.560 | 26.806 | 3.619  | 0.598 | 6.593 | 19.073 |
Loading and preparing results...
DONE (t=0.01s)
creating index...
index created!
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.fast_eval_api]: </span>Evaluate annotation type *segm*
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.fast_eval_api]: </span>COCOeval_opt.evaluate() finished in 0.03 seconds.
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.fast_eval_api]: </span>Accumulating evaluation results...
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.fast_eval_api]: </span>COCOeval_opt.accumulate() finished in 0.00 seconds.
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.061
 Average Precision  (AP) @[ IoU=0.50      | area=   all | maxDets=100 ] = 0.219
 Average Precision  (AP) @[ IoU=0.75      | area=   all | maxDets=100 ] = 0.011
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.000
 Average Precision  (AP) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.032
 Average Precision  (AP) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.136
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=  1 ] = 0.005
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets= 10 ] = 0.033
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=   all | maxDets=100 ] = 0.111
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= small | maxDets=100 ] = 0.007
 Average Recall     (AR) @[ IoU=0.50:0.95 | area=medium | maxDets=100 ] = 0.085
 Average Recall     (AR) @[ IoU=0.50:0.95 | area= large | maxDets=100 ] = 0.200
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.coco_evaluation]: </span>Evaluation results for segm: 
|  AP   |  AP50  |  AP75  |  APs  |  APm  |  APl   |
|:-----:|:------:|:------:|:-----:|:-----:|:------:|
| 6.114 | 21.873 | 1.054  | 0.040 | 3.191 | 13.633 |
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span><span class=" -Color -Color-Green">[06/27 23:15:17 d2.engine.defaults]: </span>Evaluation results for trees_test1 in csv format:
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.testing]: </span>copypaste: Task: bbox
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.testing]: </span>copypaste: AP,AP50,AP75,APs,APm,APl
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.testing]: </span>copypaste: 9.5605,26.8062,3.6192,0.5977,6.5930,19.0734
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.testing]: </span>copypaste: Task: segm
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.testing]: </span>copypaste: AP,AP50,AP75,APs,APm,APl
<span class=" -Color -Color-Green">[06/27 23:15:17 d2.evaluation.testing]: </span>copypaste: 6.1142,21.8726,1.0536,0.0396,3.1908,13.6327
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="notebooks.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Content with notebooks</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By James Ball<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>